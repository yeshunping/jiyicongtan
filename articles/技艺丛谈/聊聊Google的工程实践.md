也许你是被标题吸引进来的，为避免误解，这里需要事先声明下，本身从来没有在谷歌实习或者工作过，因此，张小龙的那句话“我所说的，都是错的”倒是很适合本文。就这个角度而言，标题叫做「从Googler学到的工程实践」可能比较恰当。

先说一下我的工作精力，我实习的第一家公司叫云壤，云壤有很多的ex-Googler，创始人是谷歌中国工程院副院长，他搭建的早期团队，基本都是谷歌工程师。在这家公司工作了两年的时间。目前所在的公司和谷歌的关系也比较特殊，不仅CEO和CTO都是谷歌出来的，而且在C轮还拿到了谷歌的投资。前段时间写过《How Google Works》的施密特，还到我们参观了一趟。目前我在这家公司呆了大概五年半时间，多少也对谷歌的一些文化有了更多的了解。

除此之外，最近两年详细阅读了不少jeff dean 和 sanjay ghemawat论文，也算是加深了对谷歌工程文化的理解。

之所以想聊聊这个话题，是因为这几天我们一个同事翻译了《Software Engineering at Google》这份文档。翻译文章是《Google软件工程之道》，有兴趣的可以阅读下。下面围绕这份文档的话题，聊聊我这几年的一些理解。

## 代码仓库
谷歌基本使用单一代码仓库，大家基于master进行开发。我呆的第一家公司也是这么干的。当时我们基于SVN来做代码管理，我们在master branch上创建了一个experiment目录，每个人在上面创建一个自己的文件夹，可以把未经review的代码提交到这个文件夹。

单一的一个仓库当然会有很多问题，比如代码庞大，新人checkout 代码需要花费不少时间，编译缓慢等。谷歌使用的是分布式编译系统，使用几百甚至上千台服务器，这对绝大部分公司来说都是巨大的成本，非常奢侈。我们当时使用的也是分布式编译，不过主要还是借助每个人的工作电脑。

当时云壤有一个目标是让每台电脑都可以登陆任何人的账号，随便换台电脑都可以开始写代码。当时使用的是LDAP + NFS，不过早期发生了很多次故障，导致全公司的人都没法干活，只能开始聊聊天。当时机器故障几乎是成为除了TGIF外，最佳的促进团队沟通的时间。

单一的代码仓库也会有很多问题，比如权限的管理。你的代码大家都能看到，这会引入很多的管理成本。比如，有一些代码库，你希望大家能够access最新版本，但是又不想让代码被看到，怎么办？当时我们的解决方式是，引入 public/internal 两个不同的目录，结合定制化的SVN 插件和jenkins job来实现。public 目录放对外可见的接口，internal 放内部实现。如果你没有权限，编译的时候会依赖上提交上来的pre-build 的静态库。

Git 起来后，使用单一的repo应该比较少了，想要强力推动也有很多的顾虑。毕竟，一套应对86T代码的内部系统，不是任何公司都有能力去开发的。

在若干年前，百度的基础架构部在推类似的事情，不知道后来是否执行了。不过听说百度内部的类gRPC 框架有好几套，并且没看出来哪一个有一统百度之势。这不，后来谷歌自己的gRPC 都开源了。想来在百度要学习谷歌的基础架构，并不简单。

## 构建系统

怎么让编译变得简单应该是关注工程师生活质量最重要的事情。工程师的生命，除了耗费在重新造轮子上外，浪费在编译上的大好年华应该也数不胜数。当你写好代码，等待结果输出的时候，是最焦灼的，我猜想父母等待子女出生也不过如此。

当时还没有开源的Google bazel，所以云壤的同事开发了一套简化版本的构建系统，内部名字叫做ymake，支持的语法基本和 bazel 差不多，不过功能稍微少一些，比如还不能支持依赖关系查询等。刚到云壤的我，觉得这工具真牛逼，相见恨晚。在这之前，我负责一个Windows项目，因为项目依赖的开源项目有点多，我花了很多的精力在整理编译的配置。而有了类似Google构建工具的ymake，工程师工作中很少需要去关注怎么编译程序，你只需要写代码就行了。
3. 
## 代码审查


## 软件测试

## 调试与剖析

## 上线与发布

## 代码重写

## OKR

## 20%时间

## 绩效考核

## TGIF

## 谷歌的大佬们


<!--stackedit_data:
eyJoaXN0b3J5IjpbMTQzNTIyOTM4Ml19
-->